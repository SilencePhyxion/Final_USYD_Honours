This is the code I used in the Honours project
